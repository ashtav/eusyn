import{C as U,r as y,k as F,o as G,u as J,A as Q,I as R,_ as W,a as d,c as v,n as A,t as I,m as V,d as b,e as B,p as X,F as $,b as N,i as Y}from"./CUMUyx1W.js";import{t as r}from"./CczvJgXj.js";const Z=U({inheritAttrs:!1,emits:["update:modelValue","enter","change","focus"],props:{modelValue:{default:"",type:[Number,String,Array]},label:{type:String,default:null},hint:{type:String,default:null},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},prefix:{type:String,default:null},suffix:{type:String,default:null},options:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},duplicate:{type:Boolean,default:!1}},setup(e,{emit:u,attrs:E}){const S=R(),f=y(e.multiple?"":e.modelValue),g=y(e.options),s=y(null),o=y(!1),i=y(!1),h=y(null),k=y(null),c=y(-1),t=y(Array.isArray(e.modelValue)?e.modelValue:[]),L=async l=>{var a,p;await Q();const n=l!=null?(a=k.value)==null?void 0:a.querySelectorAll("li")[l]:(p=k.value)==null?void 0:p.querySelector("li.selected");n&&k.value&&(k.value.scrollTop=n.offsetTop-k.value.clientHeight/2+n.clientHeight/2)},K=l=>{f.value=l.target.value.toLowerCase(),g.value=e.options.filter(n=>{const a=r(n).toLowerCase().includes(f.value);return e.multiple?a&&!t.value.map(p=>r(p,!0)).includes(r(n,!0)):a}),i.value||(i.value=!0)},j=l=>{i.value=!0,u("focus",!0),L();const n=e.options.findIndex(a=>a===s.value);c.value=n===-1?-1:n,e.multiple&&!e.duplicate&&(g.value=e.options.filter(a=>!t.value.map(p=>r(p,!0)).includes(r(a,!0))))},O=()=>{f.value=r(s.value),u("focus",!1),setTimeout(()=>{i.value=!1,c.value=-1,e.multiple||(g.value=e.options)},1)},C=l=>{if(e.multiple){(t.value.findIndex(n=>n==l)==-1||e.duplicate)&&(t.value.push(l),u("update:modelValue",t.value.map(n=>r(n,!0))),u("change",t.value));return}f.value=r(l),s.value=l,u("update:modelValue",r(l,!0)),u("change",l)},D=l=>{t.value.splice(l,1),u("update:modelValue",t.value.map(n=>r(n,!0))),u("change",t.value)},M=()=>{t.value=[],u("update:modelValue",t.value),u("change",t.value)},P=l=>{var n,a;if(l.keyCode==13&&((a=(n=S==null?void 0:S.vnode)==null?void 0:n.props)!=null&&a.onEnter)){const p=g.value;setTimeout(()=>{f.value!=r(s.value)&&p.length!=0&&f.value!=""&&(C(p[0]),h.value.blur())},10),u("enter",f.value),i.value=!1}},z=()=>{if(!s.value)return h.value.focus();s.value=null,f.value="",u("update:modelValue",""),u("change",null)},w=()=>{setTimeout(()=>{if(e.multiple&&Array.isArray(e.modelValue)){const a=e.modelValue;if(Array.isArray(e.options)&&e.options.length>0&&e.options.every(m=>typeof m=="object"&&m!==null)){t.value=e.modelValue.map(m=>{const q=e.options.find(H=>H.value===m);return q||m});return}if(Array.isArray(a)&&a.every(m=>typeof m=="number"&&!isNaN(m))){t.value=e.modelValue.map(m=>m.toString());return}t.value=e.modelValue;return}const l=e.modelValue,n=e.options.find(a=>`${r(a,!0)}`.toLowerCase()==`${l}`.toLowerCase());if(n){s.value=n,f.value=r(n);return}s.value=null,f.value=""},10)},T=()=>{e.autofocus&&h.value&&setTimeout(()=>{h.value.focus()},10)};return F(()=>e.modelValue,l=>{w()}),F(()=>e.options,l=>{g.value=l,w()}),G(()=>{w(),T(),document.addEventListener("keydown",l=>{if(!i.value)return;const n=g.value;n.length&&((l.key==="ArrowDown"||l.key==="ArrowUp")&&(c.value=l.key==="ArrowDown"?c.value+1>=n.length?0:c.value+1:c.value-1<0?n.length-1:c.value-1,L(c.value)),l.key==="Enter"&&c.value>=0&&(c.value!=-1&&C(n[c.value]),O(),h.value.blur()))})}),{utils:J,labelInput:f,localOptions:g,selected:s,isFocus:i,refSelect:h,refOption:k,isLoading:o,values:t,indexToSelect:c,onInput:K,onFocus:j,onBlur:O,onSelect:C,onKeyPress:P,onSuffix:z,textOption:r,doFocus:T,setLoading:l=>{o.value=l},removeItem:D,onClean:M}}}),_={class:"input-icon"},x={key:0,class:"input-icon-addon"},ee=["value","placeholder","required","disabled","autofocus"],le={class:"suffix"},ne={key:0,class:"spinner-border spinner-border-sm"},ue={key:1,class:"options"},oe={ref:"refOption"},ae=["onMousedown"],te={key:0,class:"text-muted pe-none"},se={key:1,class:"multiple"},ie={class:"me-2"};function re(e,u,E,S,f,g){const s=Y;return d(),v("div",{class:A(["select",e.utils.on(e.disabled||e.isLoading,"disabled")])},[e.label?(d(),v("label",{key:0,class:A(["form-label",e.utils.on(e.required,"required")])},I(e.label),3)):V("",!0),b("div",_,[e.prefix?(d(),v("span",x,[B(s,{icon:e.prefix,size:"input-prefix"},null,8,["icon"])])):V("",!0),b("input",{ref:"refSelect",value:e.labelInput,class:A(["form-control",e.utils.on(e.isFocus,"has-focus")]),placeholder:e.hint,maxlength:255,required:e.required,disabled:e.disabled||e.isLoading,autofocus:e.autofocus,name:"select",autocomplete:"off",onInput:u[0]||(u[0]=(...o)=>e.onInput&&e.onInput(...o)),onFocus:u[1]||(u[1]=(...o)=>e.onFocus&&e.onFocus(...o)),onBlur:u[2]||(u[2]=(...o)=>e.onBlur&&e.onBlur(...o)),onKeypress:u[3]||(u[3]=(...o)=>e.onKeyPress&&e.onKeyPress(...o))},null,42,ee),b("div",le,[e.values.length>0?(d(),v("span",{key:0,onClick:u[4]||(u[4]=(...o)=>e.onClean&&e.onClean(...o)),tooltip:"Clear"},[B(s,{icon:"delete-02"})])):V("",!0),b("span",{onClick:u[5]||(u[5]=(...o)=>e.onSuffix&&e.onSuffix(...o))},[e.isLoading?(d(),v("i",ne)):(d(),X(s,{key:1,icon:e.selected?"hgi-cancel-01":e.suffix??"hgi-arrow-down-01"},null,8,["icon"]))])]),e.isFocus?(d(),v("div",ue,[b("ul",oe,[(d(!0),v($,null,N(e.localOptions,(o,i)=>(d(),v("li",{key:i,class:A({selected:o==e.selected,hovered:e.indexToSelect==i}),onMousedown:h=>e.onSelect(o)},[b("span",null,I(e.textOption(o)),1)],42,ae))),128)),e.localOptions.length==0?(d(),v("li",te," Not found. ")):V("",!0)],512)])):V("",!0)]),e.multiple?(d(),v("ul",se,[(d(!0),v($,null,N(e.values,(o,i)=>(d(),v("li",{key:i},[b("span",ie,I(e.textOption(o)),1),B(s,{icon:"cancel-01 fix",onClick:h=>e.removeItem(i)},null,8,["onClick"])]))),128))])):V("",!0)],2)}const ve=W(Z,[["render",re],["__scopeId","data-v-9b3bc85a"]]);export{ve as _};
